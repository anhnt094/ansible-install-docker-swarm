---
- name: Check if docker is installed
  command: docker -v
  register: docker_installed_check
  ignore_errors: yes

- include_tasks: setup_repo.yml
  when: docker_installed_check is failed

- include_tasks: copy_source.yml
  when: docker_installed_check is failed

- include_tasks: install_docker.yml
  when: docker_installed_check is failed

- include_tasks: install_docker_compose.yml
  when: docker_installed_check is failed

- name: Start Docker
  systemd: 
    name: docker
    state: started
    enabled: yes
